Процедура бекапа и восстановления баз данных.
Умеет:
-работать с linked серверами при наличии соответствующих прав доступа;
-восстанавливать trn файлы в правильном порядке;
-работать с несколькими серверами и базами за один запуск.
Работа проверялась на 2005, 2012. На 2000 не работает.

Выполнение:
exec	dbo.BackupRestore
		@tPlan	text		-- maintenance план в XML
		,@tMessage	text	out	-- сообщение об ошибках

Предполагаются имена файлов, совместимые с SSIS Maintenance Plan
'%2[0-9][0-9][0-9][_][0-1][0-9][_][0-3][0-9][_][0-2][0-9][0-5][0-9][0-5][0-9][_][0-9][0-9][0-9][0-9][0-9][0-9][0-9].%' для sql 2012
'%2[0-9][0-9][0-9][0-1][0-9][0-3][0-9][0-2][0-9][0-5][0-9].%' для sql 2005

После восстановления- стирает файлы бекапов.